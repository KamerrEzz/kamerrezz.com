---
import BaseHead from '../components/BaseHead.astro';
import ProfileHeader from '../components/ProfileHeader.astro';
import { SITE_TITLE } from '../consts';
import { getCollection } from 'astro:content';

const projects = await getCollection('projects');
const sortedProjects = projects.sort((a, b) => {
	const dateA = a.data.date ? new Date(a.data.date).getTime() : 0;
	const dateB = b.data.date ? new Date(b.data.date).getTime() : 0;
	return dateB - dateA;
});
---

<!doctype html>
<html lang="es">
	<head>
		<BaseHead title={`Proyectos - ${SITE_TITLE}`} description="Todos los proyectos de Kamerr Ezz" />
	</head>
	<body class="min-h-screen bg-[#0A0A0A] text-white">
		<div class="max-w-2xl mx-auto px-4 md:px-6 py-8">
			<ProfileHeader activeTab="projects" />

			{/* Projects List */}
			<div class="space-y-0">
				{sortedProjects.map((project) => {
					const getStatusText = (status?: string) => {
						if (status === 'completed' || status === 'active') return 'Activo';
						if (status === 'in-progress') return 'En evolución';
						return 'En evolución';
					};

					return (
						<a
							href={`/projects/${project.id}/`}
							class="block border-b border-[#374151] py-4 first:pt-0 hover:bg-[#0F0F0F] transition-colors rounded px-2 -mx-2"
						>
							<div class="flex items-start gap-4">
								{/* Folder Icon */}
								<div class="flex-shrink-0 mt-1">
									<svg
										class="w-5 h-5"
										fill="none"
										stroke="currentColor"
										viewBox="0 0 24 24"
										style="color: #d5338b;"
									>
										<path
											stroke-linecap="round"
											stroke-linejoin="round"
											stroke-width="2"
											d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"
										></path>
									</svg>
								</div>

								{/* Project Content */}
								<div class="flex-1 min-w-0">
									<div class="flex items-start justify-between gap-4 mb-2">
										<h3 class="text-white font-semibold text-base md:text-lg">
											{project.data.title}
										</h3>
										<svg
											class="w-4 h-4 text-[#9CA3AF] flex-shrink-0 mt-1"
											fill="none"
											stroke="currentColor"
											viewBox="0 0 24 24"
										>
											<path
												stroke-linecap="round"
												stroke-linejoin="round"
												stroke-width="2"
												d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"
											></path>
										</svg>
									</div>

									<p class="text-[#9CA3AF] text-sm mb-3 line-clamp-1">
										{project.data.description}
									</p>

									{/* Status Tag */}
									<div>
										<span
											class="inline-block px-2 py-1 text-xs font-medium rounded-full"
											style="background-color: #1A1A1A; color: #d5338b;"
										>
											{getStatusText(project.data.status)}
										</span>
									</div>
								</div>
							</div>
						</a>
					);
				})}
			</div>

			{/* Footer */}
			<footer class="mt-12 pt-8 text-center text-sm text-[#9CA3AF]">
				<p>© Kamerr Ezz — zeew.space</p>
			</footer>
		</div>
	</body>
</html>